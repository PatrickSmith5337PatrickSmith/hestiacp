<div class="l-center">
  <div class="l-sort clearfix noselect">
    <div class="l-unit-toolbar__buttonstrip">
      <? if (($_SESSION['userContext'] === 'admin') && ($_SESSION['look'] === 'admin')) {?>
        <a href="/list/user/" id="btn-back" class="ui-button cancel" dir="ltr"><i class="fas fa-arrow-left status-icon blue"></i><?=_('Back')?></a>
      <? } else if (($_SESSION['userContext'] === 'admin') && ($_GET['user'] === 'admin')) { ?>
        <a href="/list/server/" id="btn-back" class="ui-button cancel" dir="ltr"><i class="fas fa-arrow-left status-icon blue"></i><?=_('Back')?></a>
      <? } else {?>
        <a href="/edit/user/?user=<?php echo $user; ?>&token=<?=$_SESSION['token']?>" id="btn-back" class="ui-button cancel" dir="ltr"><i class="fas fa-arrow-left status-icon blue"></i><?=_('Back')?></a>
      <? } ?>
      <? if (($_SESSION['userContext'] === 'admin') && ($_GET['user'] !== 'admin')) { ?>
        <a href="/list/log/auth/" id="btn-list" class="ui-button cancel" dir="ltr" title="<?=_('Login history');?>"><i class="fas fa-binoculars status-icon green"></i><?=_('Login history')?></a>
      <? } ?>
    </div>
    <div class="l-unit-toolbar__buttonstrip float-right">
      <a href="javascript:location.reload();" class="ui-button cancel" dir="ltr"><i class="fas fa-redo status-icon green"></i><?=_('Refresh')?></a>
    <? if (($_SESSION['userContext'] === 'admin') && ($_SESSION['look'] === 'admin') && ($_SESSION['POLICY_SYSTEM_PROTECTED_ADMIN'] === 'yes')) {?>
      <!-- Hide delete buttons-->
    <? } else { ?>
      <? if (($_SESSION['userContext'] === 'admin') || (($_SESSION['userContext'] === 'user') && ($_SESSION['POLICY_USER_DELETE_LOGS'] !== 'no'))) {?>
        <div class="actions-panel display-inline-block" key-action="js">
          <a class="data-controls do_delete ui-button danger cancel">
            <i class="do_delete fas fa-times-circle status-icon red"></i><?=_('Delete')?>
            <? if (($_SESSION['userContext'] === 'admin') && ($_GET['user'] === 'admin')) {?>
              <input type="hidden" name="delete_url" value="/delete/log/?user=admin&token=<?=$_SESSION['token']?>" />
            <? } else { ?>
              <input type="hidden" name="delete_url" value="/delete/log/?token=<?=$_SESSION['token']?>" />
            <? } ?>
              <div class="confirmation-text-delete hidden" title="<?=_('Confirmation')?>">
                <p class="confirmation"><?=_('DELETE_LOGS_CONFIRMATION')?></p>
              </div>
            </a>
          </div>
        <? } ?>
      <? } ?>
    </div>
  </div>
</div>

<div class="l-separator"></div>

<div class="l-center units">

  <div class="header table-header">     
    <div class="l-unit__col l-unit__col--right">
      <div class="clearfix l-unit__stat-col--left super-compact text-center">&nbsp;</div>
      <div class="clearfix l-unit__stat-col--left"><b><?php print _('Date');?></b></div>
      <div class="clearfix l-unit__stat-col--left compact-2"><b><?php print _('Time');?></b></div>

      <div class="clearfix l-unit__stat-col--left"><b><?php print _('Category');?></b></div>
      <div class="clearfix l-unit__stat-col--left"><b><?php print _('Message');?></b></div>
    </div>
  </div>

  <?php
      foreach ($data as $key => $value) {
        ++$i;
      ?>
      <div class="l-unit header animated fadeIn">
        <div class="l-unit__col l-unit__col--right">
          <div class="clearfix l-unit__stat-col--left super-compact text-center">
            <? if ($data[$key]['LEVEL'] === 'Info') {?>
              <i class="fas fa-info-circle status-icon blue"></i>
            <? } ?>
            <? if ($data[$key]['LEVEL'] === 'Warning') {?>
              <i class="fas fa-exclamation-triangle status-icon orange"></i>
            <? } ?>
            <? if ($data[$key]['LEVEL'] === 'Error') {?>
              <i class="fas fa-times-circle status-icon red"></i>
            <? } ?>
          </div>
          <div class="clearfix l-unit__stat-col--left"><b><?=translate_date($data[$key]['DATE'])?></b></div>
          <div class="clearfix l-unit__stat-col--left compact-2"><b><?=$data[$key]['TIME']?></b></div>

          <div class="clearfix l-unit__stat-col--left"><b><?=$data[$key]['CATEGORY']?></b></div>
          <div class="clearfix l-unit__stat-col--left wide-7"><?=htmlspecialchars($data[$key]['MESSAGE'], ENT_QUOTES)?></div>
        </div>
      </div>
  <?}?>
</div>

<div id="vstobjects">
  <div class="l-separator"></div>
  <div class="l-center">
    <div class="l-unit-ft">
      <table class='data'></table>
      <div class="data-count l-unit__col l-unit__col--right clearfix">
        <?
          printf(ngettext('%d log record', '%d log records', $i),$i);
        ?>
      </div>
    </div>
  </div>
</div>
