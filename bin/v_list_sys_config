#!/bin/bash
# info: listing system ip

#----------------------------------------------------------#
#                    Variable&Function                     #
#----------------------------------------------------------#

# Argument defenition
format="${1-shell}"

# Importing variables
source $VESTA/conf/vars.conf
source $V_FUNC/shared_func.sh


#----------------------------------------------------------#
#                       Action                             #
#----------------------------------------------------------#

# Defining functions
conf_shell_list() {
    for str in $(cat $V_CONF/vesta.conf);do 
        key=${str%%=*}
        value=${str#*=}
        echo "$key ${value//\'/}"
    done
}

conf_json_list() {
    lines=$(wc -l $V_CONF/vesta.conf|cut -f 1 -d ' ')
    i='0'
    echo -e "{\n\t\"config\": {"
    for str in $(cat $V_CONF/vesta.conf); do
        i=$((i + 1))
        key=${str%%=*}
        value=${str#*=}

        if [ "$i" -lt "$lines" ]; then
            echo -e "\t\t\"$key\": \"${value//\'/}\","
        else
            echo -e "\t\t\"$key\": \"${value//\'/}\""
        fi
    done
    echo -e "\t}\n}"
}


# Listing system config
case $format in 
    json) conf_json_list ;;
    shell) conf_shell_list | column -t ;;
    *) check_args '1' "0" '[format]'
esac


#----------------------------------------------------------#
#                       Vesta                              #
#----------------------------------------------------------#

# Logging
log_event 'system' "$V_EVENT"

exit  $OK
